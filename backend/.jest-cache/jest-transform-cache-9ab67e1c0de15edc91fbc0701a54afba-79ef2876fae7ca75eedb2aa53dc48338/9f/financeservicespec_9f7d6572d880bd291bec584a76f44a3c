48f0afca77c63fe77c1cdbdfe633fec6
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const common_1 = require("@nestjs/common");
const finance_service_1 = require("./finance.service");
describe('FinanceService', () => {
    let service;
    let prisma;
    let realtime;
    beforeEach(() => {
        prisma = {
            receivable: {
                findFirst: jest.fn(),
                findMany: jest.fn(),
                update: jest.fn(),
                updateMany: jest.fn(),
                aggregate: jest.fn(),
                count: jest.fn(),
            },
            payment: {
                create: jest.fn(),
                aggregate: jest.fn(),
            },
            warung: {
                findFirst: jest.fn(),
                update: jest.fn(),
                updateMany: jest.fn(),
            },
            $transaction: jest.fn(),
        };
        prisma.$transaction.mockImplementation(async (arg) => {
            if (Array.isArray(arg)) {
                return Promise.all(arg);
            }
            return arg(prisma);
        });
        realtime = { emit: jest.fn() };
        service = new finance_service_1.FinanceService(prisma, realtime);
    });
    describe('createPayment', () => {
        it('throws NotFoundException when receivable not found', async () => {
            prisma.receivable.findFirst.mockResolvedValue(null);
            await expect(service.createPayment('admin-1', {
                receivableId: 'rec-1',
                amount: 100,
                method: 'CASH',
            })).rejects.toBeInstanceOf(common_1.NotFoundException);
        });
        it('throws BadRequestException when amount exceeds balance', async () => {
            prisma.receivable.findFirst.mockResolvedValue({
                id: 'rec-1',
                warungId: 'w-1',
                balance: 100,
                paidAmount: 0,
                dueDate: new Date('2026-01-01'),
                warung: { id: 'w-1' },
            });
            await expect(service.createPayment('admin-1', {
                receivableId: 'rec-1',
                amount: 200,
                method: 'TRANSFER',
            })).rejects.toBeInstanceOf(common_1.BadRequestException);
        });
        it('updates receivable and warung debt on success', async () => {
            prisma.receivable.findFirst.mockResolvedValue({
                id: 'rec-1',
                warungId: 'w-1',
                balance: 100,
                paidAmount: 0,
                dueDate: new Date('2026-01-01'),
                warung: { id: 'w-1' },
            });
            prisma.payment.create.mockResolvedValue({ id: 'pay-1' });
            prisma.receivable.update.mockResolvedValue({
                id: 'rec-1',
                balance: 0,
                paidAmount: 100,
                status: 'PAID',
            });
            prisma.warung.update.mockResolvedValue({ id: 'w-1' });
            prisma.receivable.findMany.mockResolvedValue([]);
            prisma.warung.updateMany.mockResolvedValue({ count: 0 });
            const result = await service.createPayment('admin-1', {
                receivableId: 'rec-1',
                amount: 100,
                method: 'TRANSFER',
            });
            expect(prisma.payment.create).toHaveBeenCalledWith(expect.objectContaining({
                data: expect.objectContaining({
                    receivableId: 'rec-1',
                    amount: 100,
                    method: 'TRANSFER',
                    verifiedBy: 'admin-1',
                }),
            }));
            expect(prisma.warung.update).toHaveBeenCalledWith(expect.objectContaining({
                where: { id: 'w-1' },
                data: { currentDebt: { decrement: 100 } },
            }));
            expect(result).toHaveProperty('payment');
            expect(result).toHaveProperty('receivable');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL21hY200L0RvY3VtZW50cy9Qcm9qZWsvQlVNQVNhbnNvci9iYWNrZW5kL3NyYy9maW5hbmNlL2ZpbmFuY2Uuc2VydmljZS5zcGVjLnRzIiwibWFwcGluZ3MiOiI7O0FBQUEsMkNBQXdFO0FBQ3hFLHVEQUFtRDtBQUVuRCxRQUFRLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFO0lBQzlCLElBQUksT0FBdUIsQ0FBQztJQUM1QixJQUFJLE1BQVcsQ0FBQztJQUNoQixJQUFJLFFBQWEsQ0FBQztJQUVsQixVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2QsTUFBTSxHQUFHO1lBQ1AsVUFBVSxFQUFFO2dCQUNWLFNBQVMsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO2dCQUNwQixRQUFRLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtnQkFDbkIsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7Z0JBQ2pCLFVBQVUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO2dCQUNyQixTQUFTLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtnQkFDcEIsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7YUFDakI7WUFDRCxPQUFPLEVBQUU7Z0JBQ1AsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7Z0JBQ2pCLFNBQVMsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO2FBQ3JCO1lBQ0QsTUFBTSxFQUFFO2dCQUNOLFNBQVMsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO2dCQUNwQixNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtnQkFDakIsVUFBVSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7YUFDdEI7WUFDRCxZQUFZLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtTQUN4QixDQUFDO1FBRUYsTUFBTSxDQUFDLFlBQVksQ0FBQyxrQkFBa0IsQ0FBQyxLQUFLLEVBQUUsR0FBUSxFQUFFLEVBQUU7WUFDeEQsSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENB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TUFBTSxHQUFHLE1BQU0sT0FBTyxDQUFDLGFBQWEsQ0FBQyxTQUFTLEVBQUU7Z0JBQ3BELFlBQVksRUFBRSxPQUFPO2dCQUNyQixNQUFNLEVBQUUsR0FBRztnQkFDWCxNQUFNLEVBQUUsVUFBVTthQUNaLENBQUMsQ0FBQztZQUVWLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLG9CQUFvQixDQUNoRCxNQUFNLENBQUMsZ0JBQWdCLENBQUM7Z0JBQ3RCLElBQUksRUFBRSxNQUFNLENBQUMsZ0JBQWdCLENBQUM7b0JBQzVCLFlBQVksRUFBRSxPQUFPO29CQUNyQixNQUFNLEVBQUUsR0FBRztvQkFDWCxNQUFNLEVBQUUsVUFBVTtvQkFDbEIsVUFBVSxFQUFFLFNBQVM7aUJBQ3RCLENBQUM7YUFDSCxDQUFDLENBQ0gsQ0FBQztZQUVGLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLG9CQUFvQixDQUMvQyxNQUFNLENBQUMsZ0JBQWdCLENBQUM7Z0JBQ3RCLEtBQUssRUFBRSxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUU7Z0JBQ3BCLElBQUksRUFBRSxFQUFFLFdBQVcsRUFBRSxFQUFFLFNBQVMsRUFBRSxHQUFHLEVBQUUsRUFBRTthQUMxQyxDQUFDLENBQ0gsQ0FBQztZQUVGLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDekMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUM5QyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL21hY200L0RvY3VtZW50cy9Qcm9qZWsvQlVNQVNhbnNvci9iYWNrZW5kL3NyYy9maW5hbmNlL2ZpbmFuY2Uuc2VydmljZS5zcGVjLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJhZFJlcXVlc3RFeGNlcHRpb24sIE5vdEZvdW5kRXhjZXB0aW9uIH0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xuaW1wb3J0IHsgRmluYW5jZVNlcnZpY2UgfSBmcm9tICcuL2ZpbmFuY2Uuc2VydmljZSc7XG5cbmRlc2NyaWJlKCdGaW5hbmNlU2VydmljZScsICgpID0+IHtcbiAgbGV0IHNlcnZpY2U6IEZpbmFuY2VTZXJ2aWNlO1xuICBsZXQgcHJpc21hOiBhbnk7XG4gIGxldCByZWFsdGltZTogYW55O1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIHByaXNtYSA9IHtcbiAgICAgIHJlY2VpdmFibGU6IHtcbiAgICAgICAgZmluZEZpcnN0OiBqZXN0LmZuKCksXG4gICAgICAgIGZpbmRNYW55OiBqZXN0LmZuKCksXG4gICAgICAgIHVwZGF0ZTogamVzdC5mbigpLFxuICAgICAgICB1cGRhdGVNYW55OiBqZXN0LmZuKCksXG4gICAgICAgIGFnZ3JlZ2F0ZTogamVzdC5mbigpLFxuICAgICAgICBjb3VudDogamVzdC5mbigpLFxuICAgICAgfSxcbiAgICAgIHBheW1lbnQ6IHtcbiAgICAgICAgY3JlYXRlOiBqZXN0LmZuKCksXG4gICAgICAgIGFnZ3JlZ2F0ZTogamVzdC5mbigpLFxuICAgICAgfSxcbiAgICAgIHdhcnVuZzoge1xuICAgICAgICBmaW5kRmlyc3Q6IGplc3QuZm4oKSxcbiAgICAgICAgdXBkYXRlOiBqZXN0LmZuKCksXG4gICAgICAgIHVwZGF0ZU1hbnk6IGplc3QuZm4oKSxcbiAgICAgIH0sXG4gICAgICAkdHJhbnNhY3Rpb246IGplc3QuZm4oKSxcbiAgICB9O1xuXG4gICAgcHJpc21hLiR0cmFuc2FjdGlvbi5tb2NrSW1wbGVtZW50YXRpb24oYXN5bmMgKGFyZzogYW55KSA9PiB7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShhcmcpKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLmFsbChhcmcpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGFyZyhwcmlzbWEpO1xuICAgIH0pO1xuXG4gICAgcmVhbHRpbWUgPSB7IGVtaXQ6IGplc3QuZm4oKSB9O1xuICAgIHNlcnZpY2UgPSBuZXcgRmluYW5jZVNlcnZpY2UocHJpc21hLCByZWFsdGltZSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdjcmVhdGVQYXltZW50JywgKCkgPT4ge1xuICAgIGl0KCd0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gd2hlbiByZWNlaXZhYmxlIG5vdCBmb3VuZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHByaXNtYS5yZWNlaXZhYmxlLmZpbmRGaXJzdC5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBzZXJ2aWNlLmNyZWF0ZVBheW1lbnQoJ2FkbWluLTEnLCB7XG4gICAgICAgICAgcmVjZWl2YWJsZUlkOiAncmVjLTEnLFxuICAgICAgICAgIGFtb3VudDogMTAwLFxuICAgICAgICAgIG1ldGhvZDogJ0NBU0gnLFxuICAgICAgICB9IGFzIGFueSksXG4gICAgICApLnJlamVjdHMudG9CZUluc3RhbmNlT2YoTm90Rm91bmRFeGNlcHRpb24pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Rocm93cyBCYWRSZXF1ZXN0RXhjZXB0aW9uIHdoZW4gYW1vdW50IGV4Y2VlZHMgYmFsYW5jZScsIGFzeW5jICgpID0+IHtcbiAgICAgIHByaXNtYS5yZWNlaXZhYmxlLmZpbmRGaXJzdC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGlkOiAncmVjLTEnLFxuICAgICAgICB3YXJ1bmdJZDogJ3ctMScsXG4gICAgICAgIGJhbGFuY2U6IDEwMCxcbiAgICAgICAgcGFpZEFtb3VudDogMCxcbiAgICAgICAgZHVlRGF0ZTogbmV3IERhdGUoJzIwMjYtMDEtMDEnKSxcbiAgICAgICAgd2FydW5nOiB7IGlkOiAndy0xJyB9LFxuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgc2VydmljZS5jcmVhdGVQYXltZW50KCdhZG1pbi0xJywge1xuICAgICAgICAgIHJlY2VpdmFibGVJZDogJ3JlYy0xJyxcbiAgICAgICAgICBhbW91bnQ6IDIwMCxcbiAgICAgICAgICBtZXRob2Q6ICdUUkFOU0ZFUicsXG4gICAgICAgIH0gYXMgYW55KSxcbiAgICAgICkucmVqZWN0cy50b0JlSW5zdGFuY2VPZihCYWRSZXF1ZXN0RXhjZXB0aW9uKTtcbiAgICB9KTtcblxuICAgIGl0KCd1cGRhdGVzIHJlY2VpdmFibGUgYW5kIHdhcnVuZyBkZWJ0IG9uIHN1Y2Nlc3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICBwcmlzbWEucmVjZWl2YWJsZS5maW5kRmlyc3QubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBpZDogJ3JlYy0xJyxcbiAgICAgICAgd2FydW5nSWQ6ICd3LTEnLFxuICAgICAgICBiYWxhbmNlOiAxMDAsXG4gICAgICAgIHBhaWRBbW91bnQ6IDAsXG4gICAgICAgIGR1ZURhdGU6IG5ldyBEYXRlKCcyMDI2LTAxLTAxJyksXG4gICAgICAgIHdhcnVuZzogeyBpZDogJ3ctMScgfSxcbiAgICAgIH0pO1xuXG4gICAgICBwcmlzbWEucGF5bWVudC5jcmVhdGUubW9ja1Jlc29sdmVkVmFsdWUoeyBpZDogJ3BheS0xJyB9KTtcbiAgICAgIHByaXNtYS5yZWNlaXZhYmxlLnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGlkOiAncmVjLTEnLFxuICAgICAgICBiYWxhbmNlOiAwLFxuICAgICAgICBwYWlkQW1vdW50OiAxMDAsXG4gICAgICAgIHN0YXR1czogJ1BBSUQnLFxuICAgICAgfSk7XG4gICAgICBwcmlzbWEud2FydW5nLnVwZGF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IGlkOiAndy0xJyB9KTtcblxuICAgICAgcHJpc21hLnJlY2VpdmFibGUuZmluZE1hbnkubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xuICAgICAgcHJpc21hLndhcnVuZy51cGRhdGVNYW55Lm1vY2tSZXNvbHZlZFZhbHVlKHsgY291bnQ6IDAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuY3JlYXRlUGF5bWVudCgnYWRtaW4tMScsIHtcbiAgICAgICAgcmVjZWl2YWJsZUlkOiAncmVjLTEnLFxuICAgICAgICBhbW91bnQ6IDEwMCxcbiAgICAgICAgbWV0aG9kOiAnVFJBTlNGRVInLFxuICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICBleHBlY3QocHJpc21hLnBheW1lbnQuY3JlYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIGRhdGE6IGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICAgIHJlY2VpdmFibGVJZDogJ3JlYy0xJyxcbiAgICAgICAgICAgIGFtb3VudDogMTAwLFxuICAgICAgICAgICAgbWV0aG9kOiAnVFJBTlNGRVInLFxuICAgICAgICAgICAgdmVyaWZpZWRCeTogJ2FkbWluLTEnLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KSxcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChwcmlzbWEud2FydW5nLnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICB3aGVyZTogeyBpZDogJ3ctMScgfSxcbiAgICAgICAgICBkYXRhOiB7IGN1cnJlbnREZWJ0OiB7IGRlY3JlbWVudDogMTAwIH0gfSxcbiAgICAgICAgfSksXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgncGF5bWVudCcpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ3JlY2VpdmFibGUnKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==